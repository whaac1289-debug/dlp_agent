{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://dlp.example/schemas/agent_config.schema.json",
  "title": "DLP Agent Configuration",
  "type": "object",
  "additionalProperties": false,
  "properties": {
    "extension_filter": {"type": "array", "items": {"type": "string"}},
    "size_threshold": {"type": "integer", "minimum": 0},
    "usb_allow_serials": {"type": "array", "items": {"type": "string"}},
    "content_keywords": {"type": "array", "items": {"type": "string"}},
    "national_id_patterns": {"type": "array", "items": {"type": "string"}},
    "max_scan_bytes": {"type": "integer", "minimum": 1},
    "hash_max_bytes": {"type": "integer", "minimum": 1},
    "block_on_match": {"type": "boolean"},
    "alert_on_removable": {"type": "boolean"},
    "rules_config": {"type": "string"},
    "telemetry_endpoint": {"type": "string"},
    "telemetry_spool_path": {"type": "string"},
    "telemetry_ca_bundle": {"type": "string"},
    "telemetry_client_cert": {"type": "string"},
    "telemetry_client_key": {"type": "string"},
    "telemetry_pinned_spki": {"type": "string"},
    "quarantine_dir": {"type": "string"},
    "shadow_copy_dir": {"type": "string"},
    "policy_endpoint": {"type": "string"},
    "policy_api_key": {"type": "string"},
    "policy_hmac_key": {"type": "string"},
    "policy_public_key": {"type": "string"},
    "policy_store_path": {"type": "string"},
    "agent_jwt": {"type": "string"},
    "agent_shared_secret": {"type": "string"},
    "agent_protocol_version": {"type": "string"},
    "config_signature_path": {"type": "string"},
    "expected_binary_hash": {"type": "string"},
    "block_severity_threshold": {"type": "integer", "minimum": 0},
    "quarantine_severity_threshold": {"type": "integer", "minimum": 0},
    "shadow_copy_severity_threshold": {"type": "integer", "minimum": 0},
    "enable_shadow_copy": {"type": "boolean"},
    "enable_quarantine": {"type": "boolean"}
  }
}
